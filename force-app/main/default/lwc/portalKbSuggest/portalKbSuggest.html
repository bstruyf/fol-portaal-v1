<template>
    <lightning-textarea label="Omschrijf je probleem"
                        onchange={handleAantekeningChange}
                        value={aantekeningen}
                        class="slds-m-bottom_medium">
    </lightning-textarea>

    <h3 class="slds-text-heading_small slds-m-top_medium slds-m-bottom_x-small">
        Relevante KB-artikelen
    </h3>
    <p class="slds-text-body_small slds-m-top_small">
        Klik op de titel om de inhoud van het artikel te zien. Is dit een antwoord op jouw vraag, klik dan op <em>'dit is het antwoord op mijn vraag'</em> om dit artikel in je mail te ontvangen.
    </p>
    <ul>
        <template for:each={suggestedArticles} for:item="article">
            <li key={article.Id} class="slds-m-bottom_small">
                <div class="suggested-article" data-id={article.Id}>
                    
                    <!-- Klikbare titel -->
                    <a href="javascript:void(0);"
                       class="kb-title"
                       onclick={handleTitleClick}
                       data-id={article.Id}>
                        {article.Title}
                    </a>

                    <!-- Popover -->
                    <template if:true={article.showPopover}>
                        <section class="popover"
                                 data-id={article.Id}>
                            <p><strong>Environment:</strong> {article.Environment}</p>
                            <p><strong>Cause:</strong> {article.Cause}</p>
                            <p><strong>Problem:</strong> {article.Problem}</p>
                            <p><strong>Answer:</strong></p>
                            <div class="popover-answer">
                                <lightning-formatted-rich-text value={article.Answer}></lightning-formatted-rich-text>
                            </div>
                            <div class="popover-footer">
                                <button onclick={handleInsertAnswer}
                                        data-answer={article.Answer}>
                                    âœ… Dit is het antwoord op mijn vraag!
                                </button>
                            </div>
                        </section>
                    </template>
                </div>
            </li>
        </template>
    </ul>


    <!-- Debug info -->
    <template if:true={debugText}>
        <div class="slds-box slds-theme_alert-texture slds-theme_info slds-m-top_medium">
            <p><strong>Debug info:</strong></p>
            <pre>{debugText}</pre>
        </div>
    </template>
</template>